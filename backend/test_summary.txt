.............F....FFFF..FFFF.F.......F..........FFFFFFF..FF...F.F.....FF [ 69%]
FFF.FF..FF.F...................F                                         [100%]
=============================== warnings summary ===============================
../../../usr/local/lib/python3.11/site-packages/pydantic/_internal/_config.py:323: 12 warnings
  /usr/local/lib/python3.11/site-packages/pydantic/_internal/_config.py:323: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
    warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)

../../../usr/local/lib/python3.11/site-packages/passlib/utils/__init__.py:854
  /usr/local/lib/python3.11/site-packages/passlib/utils/__init__.py:854: DeprecationWarning: 'crypt' is deprecated and slated for removal in Python 3.13
    from crypt import crypt as _crypt

../../../usr/local/lib/python3.11/site-packages/pydantic/fields.py:1062
../../../usr/local/lib/python3.11/site-packages/pydantic/fields.py:1062
../../../usr/local/lib/python3.11/site-packages/pydantic/fields.py:1062
  /usr/local/lib/python3.11/site-packages/pydantic/fields.py:1062: PydanticDeprecatedSince20: `min_items` is deprecated and will be removed, use `min_length` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
    warn('`min_items` is deprecated and will be removed, use `min_length` instead', DeprecationWarning)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/test_api_integration.py::TestTicketEndpoints::test_delete_ticket
FAILED tests/test_api_integration.py::TestWebSocketFunctionality::test_websocket_ticket_events
FAILED tests/test_api_integration.py::TestLoadPreparation::test_concurrent_ticket_creation
FAILED tests/test_api_integration.py::TestLoadPreparation::test_api_performance_baseline
FAILED tests/test_bulk_operations.py::TestBulkOperations::test_bulk_move_tickets
FAILED tests/test_bulk_operations.py::TestBulkOperations::test_bulk_update_priority
FAILED tests/test_bulk_operations.py::TestBulkOperations::test_bulk_assign_tickets
FAILED tests/test_bulk_operations.py::TestBulkOperations::test_bulk_unassign_tickets
FAILED tests/test_bulk_operations.py::TestBulkOperations::test_bulk_operations_rate_limiting
FAILED tests/test_bulk_operations.py::TestBulkOperations::test_bulk_operation_performance
FAILED tests/test_drag_drop_logging.py::TestLogDragDropOperationDecorator::test_decorator_with_sync_function
FAILED tests/test_enhanced_statistics.py::TestEnhancedStatistics::test_board_statistics_with_cache
FAILED tests/test_enhanced_statistics.py::TestEnhancedStatistics::test_ticket_color_classifications
FAILED tests/test_enhanced_statistics.py::TestEnhancedStatistics::test_realtime_ticket_colors
FAILED tests/test_enhanced_statistics.py::TestEnhancedStatistics::test_realtime_ticket_colors_limits
FAILED tests/test_enhanced_statistics.py::TestEnhancedStatistics::test_column_statistics
FAILED tests/test_enhanced_statistics.py::TestEnhancedStatistics::test_column_statistics_not_found
FAILED tests/test_enhanced_statistics.py::TestEnhancedStatistics::test_drag_drop_metrics
FAILED tests/test_enhanced_statistics.py::TestEnhancedStatistics::test_clear_statistics_cache
FAILED tests/test_enhanced_statistics.py::TestEnhancedStatistics::test_performance_metrics
FAILED tests/test_error_handlers.py::TestErrorHandlers::test_general_exception_handler
FAILED tests/test_error_handlers.py::TestRequestLoggingMiddleware::test_error_request_logging
FAILED tests/test_history_endpoints.py::TestHistoryEndpoints::test_get_ticket_history_success
FAILED tests/test_history_endpoints.py::TestHistoryEndpoints::test_get_ticket_history_not_found
FAILED tests/test_history_endpoints.py::TestHistoryEndpoints::test_get_ticket_history_with_field_filter
FAILED tests/test_history_endpoints.py::TestHistoryEndpoints::test_get_ticket_transitions
FAILED tests/test_history_endpoints.py::TestHistoryEndpoints::test_get_board_activity
FAILED tests/test_history_endpoints.py::TestHistoryEndpoints::test_get_board_activity_no_tickets
FAILED tests/test_history_endpoints.py::TestHistoryEndpoints::test_get_history_statistics
FAILED tests/test_history_endpoints.py::TestHistoryEndpoints::test_history_endpoint_error_handling
FAILED tests/test_history_endpoints.py::TestHistoryEndpoints::test_history_pagination
FAILED tests/test_statistics_service.py::TestStatisticsService::test_calculate_ticket_statistics
FAILED tests/test_websocket_manager.py::TestConnectionManager::test_broadcast_to_board
33 failed, 71 passed, 16 warnings in 11.38s
---DETAILED FAILURES---
============================= test session starts ==============================
platform linux -- Python 3.11.13, pytest-8.4.1, pluggy-1.6.0
rootdir: /workspaces/agent-kanban/backend
configfile: pyproject.toml
testpaths: tests
plugins: anyio-4.10.0, cov-6.2.1, asyncio-1.1.0
asyncio: mode=Mode.AUTO, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collected 104 items / 71 deselected / 33 selected
run-last-failure: rerun previous 33 failures

tests/test_api_integration.py EFFF                                       [ 12%]
tests/test_bulk_operations.py FFFFFF                                     [ 30%]
tests/test_drag_drop_logging.py F                                        [ 33%]
tests/test_enhanced_statistics.py FFFFFFFFF                              [ 60%]
tests/test_error_handlers.py FF                                          [ 66%]
tests/test_history_endpoints.py FFFFFFFFF                                [ 93%]
tests/test_statistics_service.py F                                       [ 96%]
tests/test_websocket_manager.py F                                        [100%]

==================================== ERRORS ====================================
___________ ERROR at setup of TestTicketEndpoints.test_delete_ticket ___________
tests/test_api_integration.py:224: in setup_method
    self.board = self.client.create_board("Test Ticket Board")
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/test_api_integration.py:34: in create_board
    response.raise_for_status()
/home/vscode/.local/lib/python3.11/site-packages/httpx/_models.py:829: in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
E   httpx.HTTPStatusError: Client error '429 Too Many Requests' for url 'http://localhost:8000/api/boards/'
E   For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
=================================== FAILURES ===================================
___________ TestWebSocketFunctionality.test_websocket_ticket_events ____________
tests/test_api_integration.py:398: in test_websocket_ticket_events
    board = client.create_board("WebSocket Test Board")
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/test_api_integration.py:34: in create_board
    response.raise_for_status()
/home/vscode/.local/lib/python3.11/site-packages/httpx/_models.py:829: in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
E   httpx.HTTPStatusError: Client error '429 Too Many Requests' for url 'http://localhost:8000/api/boards/'
E   For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
_____________ TestLoadPreparation.test_concurrent_ticket_creation ______________
tests/test_api_integration.py:455: in test_concurrent_ticket_creation
    board = client.create_board("Load Test Board")
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/test_api_integration.py:34: in create_board
    response.raise_for_status()
/home/vscode/.local/lib/python3.11/site-packages/httpx/_models.py:829: in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
E   httpx.HTTPStatusError: Client error '429 Too Many Requests' for url 'http://localhost:8000/api/boards/'
E   For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
______________ TestLoadPreparation.test_api_performance_baseline _______________
tests/test_api_integration.py:491: in test_api_performance_baseline
    board = client.create_board("Performance Test Board")
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/test_api_integration.py:34: in create_board
    response.raise_for_status()
/home/vscode/.local/lib/python3.11/site-packages/httpx/_models.py:829: in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
E   httpx.HTTPStatusError: Client error '429 Too Many Requests' for url 'http://localhost:8000/api/boards/'
E   For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
__________________ TestBulkOperations.test_bulk_move_tickets ___________________
tests/test_bulk_operations.py:68: in test_bulk_move_tickets
    ticket_ids = self.create_test_tickets(3)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/test_bulk_operations.py:49: in create_test_tickets
    board_id = self.create_test_board()
               ^^^^^^^^^^^^^^^^^^^^^^^^
tests/test_bulk_operations.py:39: in create_test_board
    assert response.status_code == 200
E   assert 429 == 200
E    +  where 429 = <Response [429 Too Many Requests]>.status_code
_________________ TestBulkOperations.test_bulk_update_priority _________________
tests/test_bulk_operations.py:130: in test_bulk_update_priority
    ticket_ids = self.create_test_tickets(2)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/test_bulk_operations.py:49: in create_test_tickets
    board_id = self.create_test_board()
               ^^^^^^^^^^^^^^^^^^^^^^^^
tests/test_bulk_operations.py:39: in create_test_board
    assert response.status_code == 200
E   assert 429 == 200
E    +  where 429 = <Response [429 Too Many Requests]>.status_code
_________________ TestBulkOperations.test_bulk_assign_tickets __________________
tests/test_bulk_operations.py:155: in test_bulk_assign_tickets
    ticket_ids = self.create_test_tickets(2)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/test_bulk_operations.py:49: in create_test_tickets
    board_id = self.create_test_board()
               ^^^^^^^^^^^^^^^^^^^^^^^^
tests/test_bulk_operations.py:39: in create_test_board
    assert response.status_code == 200
E   assert 429 == 200
E    +  where 429 = <Response [429 Too Many Requests]>.status_code
________________ TestBulkOperations.test_bulk_unassign_tickets _________________
tests/test_bulk_operations.py:177: in test_bulk_unassign_tickets
    ticket_ids = self.create_test_tickets(2)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/test_bulk_operations.py:49: in create_test_tickets
    board_id = self.create_test_board()
               ^^^^^^^^^^^^^^^^^^^^^^^^
tests/test_bulk_operations.py:39: in create_test_board
    assert response.status_code == 200
E   assert 429 == 200
E    +  where 429 = <Response [429 Too Many Requests]>.status_code
____________ TestBulkOperations.test_bulk_operations_rate_limiting _____________
tests/test_bulk_operations.py:203: in test_bulk_operations_rate_limiting
    ticket_ids = self.create_test_tickets(2)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/test_bulk_operations.py:49: in create_test_tickets
    board_id = self.create_test_board()
               ^^^^^^^^^^^^^^^^^^^^^^^^
tests/test_bulk_operations.py:39: in create_test_board
    assert response.status_code == 200
E   assert 429 == 200
E    +  where 429 = <Response [429 Too Many Requests]>.status_code
______________ TestBulkOperations.test_bulk_operation_performance ______________
tests/test_bulk_operations.py:239: in test_bulk_operation_performance
    ticket_ids = self.create_test_tickets(5)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/test_bulk_operations.py:49: in create_test_tickets
    board_id = self.create_test_board()
               ^^^^^^^^^^^^^^^^^^^^^^^^
tests/test_bulk_operations.py:39: in create_test_board
    assert response.status_code == 200
E   assert 429 == 200
E    +  where 429 = <Response [429 Too Many Requests]>.status_code
_____ TestLogDragDropOperationDecorator.test_decorator_with_sync_function ______
tests/test_drag_drop_logging.py:173: in test_decorator_with_sync_function
    assert mock_log.call_count >= 2
E   AssertionError: assert 1 >= 2
E    +  where 1 = <MagicMock name='_log_structured' id='139896330526096'>.call_count
___________ TestEnhancedStatistics.test_board_statistics_with_cache ____________
tests/test_enhanced_statistics.py:77: in test_board_statistics_with_cache
    self.create_test_tickets_with_variety()
tests/test_enhanced_statistics.py:48: in create_test_tickets_with_variety
    board_id = self.create_test_board()
               ^^^^^^^^^^^^^^^^^^^^^^^^
tests/test_enhanced_statistics.py:38: in create_test_board
    assert response.status_code == 200
E   assert 429 == 200
E    +  where 429 = <Response [429 Too Many Requests]>.status_code
___________ TestEnhancedStatistics.test_ticket_color_classifications ___________
tests/test_enhanced_statistics.py:123: in test_ticket_color_classifications
    self.create_test_tickets_with_variety()
tests/test_enhanced_statistics.py:48: in create_test_tickets_with_variety
    board_id = self.create_test_board()
               ^^^^^^^^^^^^^^^^^^^^^^^^
tests/test_enhanced_statistics.py:38: in create_test_board
    assert response.status_code == 200
E   assert 429 == 200
E    +  where 429 = <Response [429 Too Many Requests]>.status_code
______________ TestEnhancedStatistics.test_realtime_ticket_colors ______________
tests/test_enhanced_statistics.py:166: in test_realtime_ticket_colors
    ticket_ids = self.create_test_tickets_with_variety()
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/test_enhanced_statistics.py:48: in create_test_tickets_with_variety
    board_id = self.create_test_board()
               ^^^^^^^^^^^^^^^^^^^^^^^^
tests/test_enhanced_statistics.py:38: in create_test_board
    assert response.status_code == 200
E   assert 429 == 200
E    +  where 429 = <Response [429 Too Many Requests]>.status_code
__________ TestEnhancedStatistics.test_realtime_ticket_colors_limits ___________
tests/test_enhanced_statistics.py:196: in test_realtime_ticket_colors_limits
    board_id = self.create_test_board()
               ^^^^^^^^^^^^^^^^^^^^^^^^
tests/test_enhanced_statistics.py:38: in create_test_board
    assert response.status_code == 200
E   assert 429 == 200
E    +  where 429 = <Response [429 Too Many Requests]>.status_code
________________ TestEnhancedStatistics.test_column_statistics _________________
tests/test_enhanced_statistics.py:211: in test_column_statistics
    self.create_test_tickets_with_variety()
tests/test_enhanced_statistics.py:48: in create_test_tickets_with_variety
    board_id = self.create_test_board()
               ^^^^^^^^^^^^^^^^^^^^^^^^
tests/test_enhanced_statistics.py:38: in create_test_board
    assert response.status_code == 200
E   assert 429 == 200
E    +  where 429 = <Response [429 Too Many Requests]>.status_code
___________ TestEnhancedStatistics.test_column_statistics_not_found ____________
tests/test_enhanced_statistics.py:249: in test_column_statistics_not_found
    board_id = self.create_test_board()
               ^^^^^^^^^^^^^^^^^^^^^^^^
tests/test_enhanced_statistics.py:38: in create_test_board
    assert response.status_code == 200
E   assert 429 == 200
E    +  where 429 = <Response [429 Too Many Requests]>.status_code
________________ TestEnhancedStatistics.test_drag_drop_metrics _________________
tests/test_enhanced_statistics.py:258: in test_drag_drop_metrics
    board_id = self.create_test_board()
               ^^^^^^^^^^^^^^^^^^^^^^^^
tests/test_enhanced_statistics.py:38: in create_test_board
    assert response.status_code == 200
E   assert 429 == 200
E    +  where 429 = <Response [429 Too Many Requests]>.status_code
______________ TestEnhancedStatistics.test_clear_statistics_cache ______________
tests/test_enhanced_statistics.py:324: in test_clear_statistics_cache
    board_id = self.create_test_board()
               ^^^^^^^^^^^^^^^^^^^^^^^^
tests/test_enhanced_statistics.py:38: in create_test_board
    assert response.status_code == 200
E   assert 429 == 200
E    +  where 429 = <Response [429 Too Many Requests]>.status_code
_______________ TestEnhancedStatistics.test_performance_metrics ________________
tests/test_enhanced_statistics.py:336: in test_performance_metrics
    self.create_test_tickets_with_variety()
tests/test_enhanced_statistics.py:48: in create_test_tickets_with_variety
    board_id = self.create_test_board()
               ^^^^^^^^^^^^^^^^^^^^^^^^
tests/test_enhanced_statistics.py:38: in create_test_board
    assert response.status_code == 200
E   assert 429 == 200
E    +  where 429 = <Response [429 Too Many Requests]>.status_code
_______________ TestErrorHandlers.test_general_exception_handler _______________
tests/test_error_handlers.py:116: in test_general_exception_handler
    response = client.get("/general_error")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/vscode/.local/lib/python3.11/site-packages/starlette/testclient.py:479: in get
    return super().get(
/home/vscode/.local/lib/python3.11/site-packages/httpx/_client.py:1053: in get
    return self.request(
/home/vscode/.local/lib/python3.11/site-packages/starlette/testclient.py:451: in request
    return super().request(
/home/vscode/.local/lib/python3.11/site-packages/httpx/_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/vscode/.local/lib/python3.11/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
/home/vscode/.local/lib/python3.11/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
/home/vscode/.local/lib/python3.11/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/vscode/.local/lib/python3.11/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/vscode/.local/lib/python3.11/site-packages/starlette/testclient.py:354: in handle_request
    raise exc
/home/vscode/.local/lib/python3.11/site-packages/starlette/testclient.py:351: in handle_request
    portal.call(self.app, scope, receive, send)
/home/vscode/.local/lib/python3.11/site-packages/anyio/from_thread.py:291: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/local/lib/python3.11/concurrent/futures/_base.py:456: in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
/usr/local/lib/python3.11/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
/home/vscode/.local/lib/python3.11/site-packages/anyio/from_thread.py:222: in _call_func
    retval = await retval_or_awaitable
             ^^^^^^^^^^^^^^^^^^^^^^^^^
/home/vscode/.local/lib/python3.11/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
/home/vscode/.local/lib/python3.11/site-packages/starlette/applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
/home/vscode/.local/lib/python3.11/site-packages/starlette/middleware/errors.py:186: in __call__
    raise exc
/home/vscode/.local/lib/python3.11/site-packages/starlette/middleware/errors.py:164: in __call__
    await self.app(scope, receive, _send)
/home/vscode/.local/lib/python3.11/site-packages/starlette/middleware/exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
/home/vscode/.local/lib/python3.11/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
/home/vscode/.local/lib/python3.11/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
/home/vscode/.local/lib/python3.11/site-packages/starlette/routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
/home/vscode/.local/lib/python3.11/site-packages/starlette/routing.py:736: in app
    await route.handle(scope, receive, send)
/home/vscode/.local/lib/python3.11/site-packages/starlette/routing.py:290: in handle
    await self.app(scope, receive, send)
/home/vscode/.local/lib/python3.11/site-packages/starlette/routing.py:78: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
/home/vscode/.local/lib/python3.11/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
/home/vscode/.local/lib/python3.11/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
/home/vscode/.local/lib/python3.11/site-packages/starlette/routing.py:75: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
/home/vscode/.local/lib/python3.11/site-packages/fastapi/routing.py:302: in app
    raw_response = await run_endpoint_function(
/home/vscode/.local/lib/python3.11/site-packages/fastapi/routing.py:213: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/test_error_handlers.py:47: in raise_general_error
    raise ValueError("Something went wrong")
E   ValueError: Something went wrong
___________ TestRequestLoggingMiddleware.test_error_request_logging ____________
tests/test_error_handlers.py:180: in test_error_request_logging
    assert any("completed" in str(call) for call in mock_logger.info.call_args_list)
E   assert False
E    +  where False = any(<generator object TestRequestLoggingMiddleware.test_error_request_logging.<locals>.<genexpr> at 0x7f3c2a7c26c0>)
_____________ TestHistoryEndpoints.test_get_ticket_history_success _____________
tests/test_history_endpoints.py:46: in test_get_ticket_history_success
    assert len(data) == 3
E   AssertionError: assert 4 == 3
E    +  where 4 = len([{'changed_at': '2025-08-18T05:07:57.436908', 'changed_by': 'system', 'field_name': 'current_column', 'id': 2283, ...}... ...}, {'changed_at': '2025-08-10T23:14:32.694048', 'changed_by': 'test_user', 'field_name': 'column', 'id': 591, ...}])
____________ TestHistoryEndpoints.test_get_ticket_history_not_found ____________
tests/test_history_endpoints.py:57: in test_get_ticket_history_not_found
    assert response.status_code == 404
E   assert 200 == 404
E    +  where 200 = <Response [200 OK]>.status_code
________ TestHistoryEndpoints.test_get_ticket_history_with_field_filter ________
tests/test_history_endpoints.py:74: in test_get_ticket_history_with_field_filter
    mock_session.exec.assert_called()
/usr/local/lib/python3.11/unittest/mock.py:908: in assert_called
    raise AssertionError(msg)
E   AssertionError: Expected 'exec' to have been called.
_______________ TestHistoryEndpoints.test_get_ticket_transitions _______________
tests/test_history_endpoints.py:112: in test_get_ticket_transitions
    assert data["current_column"] == "Done"
E   AssertionError: assert 'in_progress' == 'Done'
E
E     - Done
E     + in_progress
_________________ TestHistoryEndpoints.test_get_board_activity _________________
tests/test_history_endpoints.py:158: in test_get_board_activity
    assert len(data["activities"]) == 5
E   AssertionError: assert 4 == 5
E    +  where 4 = len([{'changed_at': '2025-08-18T05:07:57.436908', 'changed_by': 'system', 'field_name': 'current_column', 'id': 2283, ...}...1, ...}, {'changed_at': '2025-08-18T04:44:42.036293', 'changed_by': 'system', 'field_name': 'status', 'id': 1989, ...}])
___________ TestHistoryEndpoints.test_get_board_activity_no_tickets ____________
tests/test_history_endpoints.py:190: in test_get_board_activity_no_tickets
    assert data["activities"] == []
E   AssertionError: assert [{'changed_at...': 1989, ...}] == []
E
E     Left contains 4 more items, first extra item: {'changed_at': '2025-08-18T05:07:57.436908', 'changed_by': 'system', 'field_name': 'current_column', 'id': 2283, ...}
E     Use -v to get more diff
_______________ TestHistoryEndpoints.test_get_history_statistics _______________
tests/test_history_endpoints.py:213: in test_get_history_statistics
    assert response.status_code == 200
E   assert 405 == 200
E    +  where 405 = <Response [405 Method Not Allowed]>.status_code
------------------------------ Captured log call -------------------------------
WARNING  app.core.error_handlers:error_handlers.py:267 Request req_1755493748777 completed: GET /api/history/stats - 405 (0.000s)
__________ TestHistoryEndpoints.test_history_endpoint_error_handling ___________
tests/test_history_endpoints.py:254: in test_history_endpoint_error_handling
    assert response.status_code == 500
E   assert 200 == 500
E    +  where 200 = <Response [200 OK]>.status_code
_________________ TestHistoryEndpoints.test_history_pagination _________________
tests/test_history_endpoints.py:286: in test_history_pagination
    assert len(data) == 150  # This is the mock data length
    ^^^^^^^^^^^^^^^^^^^^^^^
E   AssertionError: assert 4 == 150
E    +  where 4 = len([{'changed_at': '2025-08-18T05:07:57.436908', 'changed_by': 'system', 'field_name': 'current_column', 'id': 2283, ...}... ...}, {'changed_at': '2025-08-10T23:14:32.694048', 'changed_by': 'test_user', 'field_name': 'column', 'id': 591, ...}])
____________ TestStatisticsService.test_calculate_ticket_statistics ____________
tests/test_statistics_service.py:126: in test_calculate_ticket_statistics
    assert isinstance(ticket_stats, TicketStatistics)
E   assert False
E    +  where False = isinstance(None, TicketStatistics)
------------------------------ Captured log call -------------------------------
ERROR    app.services.statistics_service:statistics_service.py:193 Error calculating ticket statistics for 1: 18000.005947 is not in list
________________ TestConnectionManager.test_broadcast_to_board _________________
tests/test_websocket_manager.py:198: in test_broadcast_to_board
    count = await manager.broadcast_to_board(message, board_id)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/services/websocket_manager.py:121: in broadcast_to_board
    enhanced_message = {
E   TypeError: 'int' object is not a mapping
=============================== warnings summary ===============================
../../../usr/local/lib/python3.11/site-packages/pydantic/_internal/_config.py:323: 12 warnings
  /usr/local/lib/python3.11/site-packages/pydantic/_internal/_config.py:323: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
    warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)

../../../usr/local/lib/python3.11/site-packages/passlib/utils/__init__.py:854
  /usr/local/lib/python3.11/site-packages/passlib/utils/__init__.py:854: DeprecationWarning: 'crypt' is deprecated and slated for removal in Python 3.13
    from crypt import crypt as _crypt

../../../usr/local/lib/python3.11/site-packages/pydantic/fields.py:1062
../../../usr/local/lib/python3.11/site-packages/pydantic/fields.py:1062
../../../usr/local/lib/python3.11/site-packages/pydantic/fields.py:1062
  /usr/local/lib/python3.11/site-packages/pydantic/fields.py:1062: PydanticDeprecatedSince20: `min_items` is deprecated and will be removed, use `min_length` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
    warn('`min_items` is deprecated and will be removed, use `min_length` instead', DeprecationWarning)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/test_api_integration.py::TestWebSocketFunctionality::test_websocket_ticket_events
FAILED tests/test_api_integration.py::TestLoadPreparation::test_concurrent_ticket_creation
FAILED tests/test_api_integration.py::TestLoadPreparation::test_api_performance_baseline
FAILED tests/test_bulk_operations.py::TestBulkOperations::test_bulk_move_tickets
FAILED tests/test_bulk_operations.py::TestBulkOperations::test_bulk_update_priority
FAILED tests/test_bulk_operations.py::TestBulkOperations::test_bulk_assign_tickets
FAILED tests/test_bulk_operations.py::TestBulkOperations::test_bulk_unassign_tickets
FAILED tests/test_bulk_operations.py::TestBulkOperations::test_bulk_operations_rate_limiting
FAILED tests/test_bulk_operations.py::TestBulkOperations::test_bulk_operation_performance
FAILED tests/test_drag_drop_logging.py::TestLogDragDropOperationDecorator::test_decorator_with_sync_function
FAILED tests/test_enhanced_statistics.py::TestEnhancedStatistics::test_board_statistics_with_cache
FAILED tests/test_enhanced_statistics.py::TestEnhancedStatistics::test_ticket_color_classifications
FAILED tests/test_enhanced_statistics.py::TestEnhancedStatistics::test_realtime_ticket_colors
FAILED tests/test_enhanced_statistics.py::TestEnhancedStatistics::test_realtime_ticket_colors_limits
FAILED tests/test_enhanced_statistics.py::TestEnhancedStatistics::test_column_statistics
FAILED tests/test_enhanced_statistics.py::TestEnhancedStatistics::test_column_statistics_not_found
FAILED tests/test_enhanced_statistics.py::TestEnhancedStatistics::test_drag_drop_metrics
FAILED tests/test_enhanced_statistics.py::TestEnhancedStatistics::test_clear_statistics_cache
FAILED tests/test_enhanced_statistics.py::TestEnhancedStatistics::test_performance_metrics
FAILED tests/test_error_handlers.py::TestErrorHandlers::test_general_exception_handler
FAILED tests/test_error_handlers.py::TestRequestLoggingMiddleware::test_error_request_logging
FAILED tests/test_history_endpoints.py::TestHistoryEndpoints::test_get_ticket_history_success
FAILED tests/test_history_endpoints.py::TestHistoryEndpoints::test_get_ticket_history_not_found
FAILED tests/test_history_endpoints.py::TestHistoryEndpoints::test_get_ticket_history_with_field_filter
FAILED tests/test_history_endpoints.py::TestHistoryEndpoints::test_get_ticket_transitions
FAILED tests/test_history_endpoints.py::TestHistoryEndpoints::test_get_board_activity
FAILED tests/test_history_endpoints.py::TestHistoryEndpoints::test_get_board_activity_no_tickets
FAILED tests/test_history_endpoints.py::TestHistoryEndpoints::test_get_history_statistics
FAILED tests/test_history_endpoints.py::TestHistoryEndpoints::test_history_endpoint_error_handling
FAILED tests/test_history_endpoints.py::TestHistoryEndpoints::test_history_pagination
FAILED tests/test_statistics_service.py::TestStatisticsService::test_calculate_ticket_statistics
FAILED tests/test_websocket_manager.py::TestConnectionManager::test_broadcast_to_board
ERROR tests/test_api_integration.py::TestTicketEndpoints::test_delete_ticket
=========== 32 failed, 71 deselected, 16 warnings, 1 error in 6.72s ============
